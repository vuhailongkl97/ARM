ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"uart.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.uart_init,"ax",%progbits
  18              		.align	1
  19              		.global	uart_init
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	uart_init:
  26              	.LFB0:
  27              		.file 1 "Src/uart.c"
   1:Src/uart.c    **** #include "project.h"
   2:Src/uart.c    **** 
   3:Src/uart.c    **** void uart_init(){
  28              		.loc 1 3 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33 0000 30B4     		push	{r4, r5}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 4, -8
  37              		.cfi_offset 5, -4
   4:Src/uart.c    **** 	
   5:Src/uart.c    **** 	unsigned int temp_reg;
   6:Src/uart.c    **** 	
   7:Src/uart.c    **** 	//enable clock for uart
   8:Src/uart.c    **** 	temp_reg = read_reg(RCC_APB2ENR, ~(1u << 4));
  38              		.loc 1 8 0
  39 0002 1E4A     		ldr	r2, .L3
  40 0004 1368     		ldr	r3, [r2]
  41              	.LVL0:
   9:Src/uart.c    ****     temp_reg |= (1 << 4);
  42              		.loc 1 9 0
  43 0006 43F01003 		orr	r3, r3, #16
  44              	.LVL1:
  10:Src/uart.c    ****     write_reg(RCC_APB2ENR, temp_reg);
  45              		.loc 1 10 0
  46 000a 1360     		str	r3, [r2]
  11:Src/uart.c    **** 	
  12:Src/uart.c    **** 	// Pb7 -RX
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 2


  13:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_MODER , ~(3u << 14 ));
  47              		.loc 1 13 0
  48 000c 1C4D     		ldr	r5, .L3+4
  49 000e 2B68     		ldr	r3, [r5]
  50              	.LVL2:
  51 0010 23F44041 		bic	r1, r3, #49152
  52              	.LVL3:
  14:Src/uart.c    **** 	temp_reg  = temp_reg | (GPIO_MODER_ALT << 14);
  53              		.loc 1 14 0
  54 0014 41F40041 		orr	r1, r1, #32768
  55              	.LVL4:
  15:Src/uart.c    **** 	write_reg(GPIOB_MODER , temp_reg );
  16:Src/uart.c    **** 	
  17:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_PUPDR , ~(3u << 14 ));
  56              		.loc 1 17 0
  57 0018 1A4C     		ldr	r4, .L3+8
  58 001a 2368     		ldr	r3, [r4]
  59 001c 23F44042 		bic	r2, r3, #49152
  60              	.LVL5:
  18:Src/uart.c    **** 	temp_reg  = temp_reg | (PULL_UP << 14);
  61              		.loc 1 18 0
  62 0020 42F48042 		orr	r2, r2, #16384
  63              	.LVL6:
  19:Src/uart.c    **** 	write_reg(GPIOB_PUPDR , temp_reg );
  20:Src/uart.c    **** 	
  21:Src/uart.c    **** 	
  22:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_AFRL , ~(0x0Fu << 28 ));
  64              		.loc 1 22 0
  65 0024 1848     		ldr	r0, .L3+12
  66 0026 0368     		ldr	r3, [r0]
  67 0028 23F07043 		bic	r3, r3, #-268435456
  68              	.LVL7:
  23:Src/uart.c    **** 	temp_reg  = temp_reg | (7u << 28);
  69              		.loc 1 23 0
  70 002c 43F0E043 		orr	r3, r3, #1879048192
  71              	.LVL8:
  24:Src/uart.c    **** 	write_reg(GPIOB_AFRL , temp_reg );
  25:Src/uart.c    **** 
  26:Src/uart.c    **** 	//Pb6 - TX
  27:Src/uart.c    **** 	
  28:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_MODER , ~(3u << 12 ));
  72              		.loc 1 28 0
  73 0030 21F44051 		bic	r1, r1, #12288
  74              	.LVL9:
  29:Src/uart.c    **** 	temp_reg  = temp_reg | (GPIO_MODER_ALT << 12);
  75              		.loc 1 29 0
  76 0034 41F40051 		orr	r1, r1, #8192
  77              	.LVL10:
  30:Src/uart.c    **** 	write_reg(GPIOB_MODER , temp_reg );
  78              		.loc 1 30 0
  79 0038 2960     		str	r1, [r5]
  31:Src/uart.c    **** 	
  32:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_PUPDR , ~(3u << 12 ));
  80              		.loc 1 32 0
  81 003a 22F44052 		bic	r2, r2, #12288
  82              	.LVL11:
  33:Src/uart.c    **** 	temp_reg  = temp_reg | (PULL_UP << 12);
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 3


  83              		.loc 1 33 0
  84 003e 42F48052 		orr	r2, r2, #4096
  85              	.LVL12:
  34:Src/uart.c    **** 	write_reg(GPIOB_PUPDR , temp_reg );
  86              		.loc 1 34 0
  87 0042 2260     		str	r2, [r4]
  35:Src/uart.c    **** 	
  36:Src/uart.c    **** 	temp_reg = read_reg(GPIOB_AFRL , ~(0x0Fu << 24 ));
  88              		.loc 1 36 0
  89 0044 23F07063 		bic	r3, r3, #251658240
  90              	.LVL13:
  37:Src/uart.c    **** 	temp_reg  = temp_reg | (7u << 24);
  91              		.loc 1 37 0
  92 0048 43F0E063 		orr	r3, r3, #117440512
  93              	.LVL14:
  38:Src/uart.c    **** 	write_reg(GPIOB_AFRL , temp_reg );
  94              		.loc 1 38 0
  95 004c 0360     		str	r3, [r0]
  39:Src/uart.c    **** 	
  40:Src/uart.c    **** 	//DISABLE UART1
  41:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1, ~(1<<13));
  96              		.loc 1 41 0
  97 004e 0F49     		ldr	r1, .L3+16
  98 0050 0B68     		ldr	r3, [r1]
  99              	.LVL15:
  42:Src/uart.c    ****     write_reg(USART_CR1, temp_reg);
  43:Src/uart.c    **** 
  44:Src/uart.c    **** 	// 1 stop 
  45:Src/uart.c    **** 	temp_reg = read_reg(USART_CR2 ,~(3 <<12));
 100              		.loc 1 45 0
 101 0052 A0F57440 		sub	r0, r0, #62464
 102 0056 1038     		subs	r0, r0, #16
 103 0058 0268     		ldr	r2, [r0]
 104 005a 22F44052 		bic	r2, r2, #12288
 105              	.LVL16:
  46:Src/uart.c    **** 	temp_reg |= (0 << 12);
  47:Src/uart.c    **** 	write_reg(USART_CR2 , temp_reg);		
 106              		.loc 1 47 0
 107 005e 0260     		str	r2, [r0]
 108              	.LVL17:
  48:Src/uart.c    **** 
  49:Src/uart.c    **** 	// data 8bit 	
  50:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1 ,~(1 <<12));
  51:Src/uart.c    **** 	write_reg(USART_CR1 , temp_reg);
  52:Src/uart.c    **** 	
  53:Src/uart.c    **** 	//no  parity 
  54:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1 ,~(1 <<10));
  55:Src/uart.c    **** 	write_reg(USART_CR1 , temp_reg);
  56:Src/uart.c    **** 	
  57:Src/uart.c    **** 	
  58:Src/uart.c    **** 	/* Clear CTSE and RTSE bits */
  59:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1 ,~(3 <<8));
  60:Src/uart.c    **** 	write_reg(USART_CR1 , temp_reg);	
  61:Src/uart.c    **** 	
  62:Src/uart.c    **** 	//no  sampleing
  63:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1 ,~(1 <<15));
 109              		.loc 1 63 0
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 4


 110 0060 23F43743 		bic	r3, r3, #46848
 111              	.LVL18:
  64:Src/uart.c    **** 	write_reg(USART_CR1 , temp_reg);
  65:Src/uart.c    **** 		
  66:Src/uart.c    **** 	//baudrate  
  67:Src/uart.c    **** 	//115200   0x0000008Bu
  68:Src/uart.c    **** 	//9600     0x00000683u  16mhz
  69:Src/uart.c    **** 	//temp_reg = 0x00000045u;
  70:Src/uart.c    **** 	
  71:Src/uart.c    **** 	
  72:Src/uart.c    **** 	//for 50Mhz , 9600bps
  73:Src/uart.c    **** 	//temp_reg = 0x00001458u;
  74:Src/uart.c    **** 	
  75:Src/uart.c    **** 	
  76:Src/uart.c    **** 	//temp_reg = 0x00000683u;  //16mhz
  77:Src/uart.c    **** 	temp_reg = 0x00000341u;   //8mhz
  78:Src/uart.c    **** 	
  79:Src/uart.c    **** 	temp_reg = 0x00000D05u;	//32mhz
  80:Src/uart.c    **** 
  81:Src/uart.c    **** 	
  82:Src/uart.c    **** 	write_reg(USART_BRR , temp_reg);
 112              		.loc 1 82 0
 113 0064 0A4A     		ldr	r2, .L3+20
 114 0066 40F60550 		movw	r0, #3333
 115 006a 1060     		str	r0, [r2]
 116              	.LVL19:
  83:Src/uart.c    **** 	
  84:Src/uart.c    **** 	//ENABLE UART1
  85:Src/uart.c    **** 	temp_reg = read_reg(USART_CR1, ~(1<<13));
  86:Src/uart.c    **** 	temp_reg |= (1<<13);
  87:Src/uart.c    ****     write_reg(USART_CR1, temp_reg);	
  88:Src/uart.c    **** 	
  89:Src/uart.c    **** 	/* Tx Enable */
  90:Src/uart.c    ****     temp_reg = read_reg(USART_CR1, ~(1<<3));
  91:Src/uart.c    ****     temp_reg |= (1 << 3);
  92:Src/uart.c    ****     write_reg(USART_CR1, temp_reg);
  93:Src/uart.c    **** 
  94:Src/uart.c    ****     /* Rx Enable */
  95:Src/uart.c    ****     temp_reg = read_reg(USART_CR1, ~(1<<2));
  96:Src/uart.c    ****     temp_reg |= (1<<2);
 117              		.loc 1 96 0
 118 006c 43F40053 		orr	r3, r3, #8192
 119              	.LVL20:
 120 0070 43F00C03 		orr	r3, r3, #12
 121              	.LVL21:
  97:Src/uart.c    ****     write_reg(USART_CR1, temp_reg);
 122              		.loc 1 97 0
 123 0074 0B60     		str	r3, [r1]
  98:Src/uart.c    **** 	
  99:Src/uart.c    **** 
 100:Src/uart.c    **** }
 124              		.loc 1 100 0
 125 0076 30BC     		pop	{r4, r5}
 126              	.LCFI1:
 127              		.cfi_restore 5
 128              		.cfi_restore 4
 129              		.cfi_def_cfa_offset 0
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 5


 130 0078 7047     		bx	lr
 131              	.L4:
 132 007a 00BF     		.align	2
 133              	.L3:
 134 007c 44380240 		.word	1073887300
 135 0080 00040240 		.word	1073873920
 136 0084 0C040240 		.word	1073873932
 137 0088 20040240 		.word	1073873952
 138 008c 0C100140 		.word	1073811468
 139 0090 08100140 		.word	1073811464
 140              		.cfi_endproc
 141              	.LFE0:
 143              		.section	.text.usart_send_byte,"ax",%progbits
 144              		.align	1
 145              		.global	usart_send_byte
 146              		.syntax unified
 147              		.thumb
 148              		.thumb_func
 149              		.fpu fpv4-sp-d16
 151              	usart_send_byte:
 152              	.LFB1:
 101:Src/uart.c    **** char usart_send_byte(unsigned char data){
 153              		.loc 1 101 0
 154              		.cfi_startproc
 155              		@ args = 0, pretend = 0, frame = 0
 156              		@ frame_needed = 0, uses_anonymous_args = 0
 157              		@ link register save eliminated.
 158              	.LVL22:
 102:Src/uart.c    **** 	
 103:Src/uart.c    **** 	unsigned int temp_reg ;
 104:Src/uart.c    **** 	// kiem tra TDR san sang nhan du lieu moi hay chua
 105:Src/uart.c    **** 	temp_reg = read_reg(USART_SR , (1 << 7));
 159              		.loc 1 105 0
 160 0000 054B     		ldr	r3, .L8
 161 0002 1B68     		ldr	r3, [r3]
 162              	.LVL23:
 106:Src/uart.c    **** 	if( temp_reg != 0){
 163              		.loc 1 106 0
 164 0004 13F0800F 		tst	r3, #128
 165 0008 03D0     		beq	.L7
 107:Src/uart.c    **** 		// bat dau truyen 
 108:Src/uart.c    **** 		write_reg(USART_DR , (unsigned int)data);
 166              		.loc 1 108 0
 167 000a 044B     		ldr	r3, .L8+4
 168              	.LVL24:
 169 000c 1860     		str	r0, [r3]
 109:Src/uart.c    **** 		
 110:Src/uart.c    **** 		return 1;
 170              		.loc 1 110 0
 171 000e 0120     		movs	r0, #1
 172              	.LVL25:
 173 0010 7047     		bx	lr
 174              	.LVL26:
 175              	.L7:
 111:Src/uart.c    **** 	}
 112:Src/uart.c    **** 	return 0;
 176              		.loc 1 112 0
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 6


 177 0012 0020     		movs	r0, #0
 178              	.LVL27:
 113:Src/uart.c    **** 	
 114:Src/uart.c    **** }
 179              		.loc 1 114 0
 180 0014 7047     		bx	lr
 181              	.L9:
 182 0016 00BF     		.align	2
 183              	.L8:
 184 0018 00100140 		.word	1073811456
 185 001c 04100140 		.word	1073811460
 186              		.cfi_endproc
 187              	.LFE1:
 189              		.section	.text.usart_send_string,"ax",%progbits
 190              		.align	1
 191              		.global	usart_send_string
 192              		.syntax unified
 193              		.thumb
 194              		.thumb_func
 195              		.fpu fpv4-sp-d16
 197              	usart_send_string:
 198              	.LFB2:
 115:Src/uart.c    **** char usart_send_string( char *str){
 199              		.loc 1 115 0
 200              		.cfi_startproc
 201              		@ args = 0, pretend = 0, frame = 0
 202              		@ frame_needed = 0, uses_anonymous_args = 0
 203              	.LVL28:
 204 0000 10B5     		push	{r4, lr}
 205              	.LCFI2:
 206              		.cfi_def_cfa_offset 8
 207              		.cfi_offset 4, -8
 208              		.cfi_offset 14, -4
 209 0002 0446     		mov	r4, r0
 210              	.LVL29:
 211              	.L11:
 116:Src/uart.c    **** 	
 117:Src/uart.c    **** 		while(*str){
 212              		.loc 1 117 0
 213 0004 2078     		ldrb	r0, [r4]	@ zero_extendqisi2
 214 0006 28B1     		cbz	r0, .L15
 118:Src/uart.c    **** 			if(usart_send_byte(*str))
 215              		.loc 1 118 0
 216 0008 FFF7FEFF 		bl	usart_send_byte
 217              	.LVL30:
 218 000c 0028     		cmp	r0, #0
 219 000e F9D0     		beq	.L11
 119:Src/uart.c    **** 				str++;
 220              		.loc 1 119 0
 221 0010 0134     		adds	r4, r4, #1
 222              	.LVL31:
 223 0012 F7E7     		b	.L11
 224              	.L15:
 120:Src/uart.c    **** 		}
 121:Src/uart.c    **** 	return 0;
 122:Src/uart.c    **** }
 225              		.loc 1 122 0
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 7


 226 0014 10BD     		pop	{r4, pc}
 227              		.cfi_endproc
 228              	.LFE2:
 230              		.text
 231              	.Letext0:
 232              		.file 2 "Inc/stm32f4xx_it.h"
ARM GAS  E:\msys32\tmp\ccytMQ5O.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 uart.c
E:\msys32\tmp\ccytMQ5O.s:18     .text.uart_init:00000000 $t
E:\msys32\tmp\ccytMQ5O.s:25     .text.uart_init:00000000 uart_init
E:\msys32\tmp\ccytMQ5O.s:134    .text.uart_init:0000007c $d
E:\msys32\tmp\ccytMQ5O.s:144    .text.usart_send_byte:00000000 $t
E:\msys32\tmp\ccytMQ5O.s:151    .text.usart_send_byte:00000000 usart_send_byte
E:\msys32\tmp\ccytMQ5O.s:184    .text.usart_send_byte:00000018 $d
E:\msys32\tmp\ccytMQ5O.s:190    .text.usart_send_string:00000000 $t
E:\msys32\tmp\ccytMQ5O.s:197    .text.usart_send_string:00000000 usart_send_string

NO UNDEFINED SYMBOLS
